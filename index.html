<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>OpenLayers â€“ Indoor & Outdoor</title>

<!-- OpenLayers CSS & JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v9.2.4/ol.css">
<script src="https://cdn.jsdelivr.net/npm/ol@v9.2.4/dist/ol.js"></script>

<style>
  html, body {margin:0; padding:0; height:100%;}
  #map {width:100%; height:100%;}
  .toolbar {
    position:absolute; top:10px; left:10px; z-index:1000;
    background:#fff; padding:6px; border-radius:6px;
    box-shadow:0 2px 6px rgba(0,0,0,.2); display:flex; gap:6px;
  }
  .toolbar input {padding:6px; width:220px;}
</style>
</head>
<body>
<div id="map"></div>

<div class="toolbar">
  <input id="searchInput" type="text" placeholder="Ara: disco, havuz, restoran, spaâ€¦" />
</div>

<script type="module">
import Map from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/Map.js";
import View from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/View.js";
import TileLayer from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/layer/Tile.js";
import OSM from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/source/OSM.js";
import {fromLonLat} from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/proj.js";
import VectorSource from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/source/Vector.js";
import VectorLayer from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/layer/Vector.js";
import GeoJSON from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/format/GeoJSON.js";
import {Fill, Stroke, Style, Circle as CircleStyle} from "https://cdn.jsdelivr.net/npm/ol@v9.2.4/style.js";

/* --- 1) Otel AlanÄ± --- */
const hotelGeoJSON = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "geometry":{
        "type":"Polygon",
        "coordinates":[[ 
          [31.80488563536983,36.60144809135009],
          [31.80141125277774,36.599560719072684],
          [31.806994242514662,36.59688713533359],
          [31.80828178115803,36.59899633325935],
          [31.80488563536983,36.60144809135009]
        ]]
      }
    }
  ]
};
const hotelSource = new VectorSource({
  features: new GeoJSON().readFeatures(hotelGeoJSON, {
    featureProjection: "EPSG:3857"
  })
});
const hotelLayer = new VectorLayer({
  source: hotelSource,
  style: new Style({
    stroke: new Stroke({color:"blue",width:2}),
    fill: new Fill({color:"rgba(0,0,255,0.05)"})
  })
});

/* --- 2) Indoor & Outdoor DEMO (sen indoor.json / outdoor.jsonâ€™dan yÃ¼kleyebilirsin) --- */
const demoIndoor = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "properties":{"name":"Lobi","category":"lobby"},
      "geometry":{
        "type":"Polygon",
        "coordinates":[[
          [31.8050,36.6005],[31.8052,36.6005],[31.8052,36.6007],[31.8050,36.6007],[31.8050,36.6005]
        ]]
      }
    }
  ]
};
const demoOutdoor = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "properties":{"name":"Disco","category":"disco"},
      "geometry":{"type":"Point","coordinates":[31.8053,36.6002]}
    }
  ]
};
const indoorLayer = new VectorLayer({
  source: new VectorSource({
    features: new GeoJSON().readFeatures(demoIndoor,{featureProjection:"EPSG:3857"})
  }),
  style: new Style({
    stroke: new Stroke({color:"green",width:2}),
    fill: new Fill({color:"rgba(0,255,0,0.3)"})
  })
});
const outdoorLayer = new VectorLayer({
  source: new VectorSource({
    features: new GeoJSON().readFeatures(demoOutdoor,{featureProjection:"EPSG:3857"})
  }),
  style: new Style({
    image: new CircleStyle({
      radius:6,
      fill: new Fill({color:"red"}),
      stroke: new Stroke({color:"#fff",width:2})
    })
  })
});

/* --- 3) Map & View --- */
const map = new Map({
  target: "map",
  layers: [
    new TileLayer({source: new OSM()}),
    hotelLayer, indoorLayer, outdoorLayer
  ],
  view: new View({
    center: fromLonLat([31.805,36.600]),
    zoom: 17,
    rotation: 0 // buradan rotate baÅŸlatÄ±lÄ±r
  })
});

/* --- 4) Search (Ã§ok basit demo) --- */
document.getElementById("searchInput").addEventListener("keydown", e=>{
  if(e.key==="Enter"){
    const val = e.target.value.toLowerCase();
    let found=null;
    outdoorLayer.getSource().forEachFeature(f=>{
      if(f.get("name") && f.get("name").toLowerCase().includes(val)){found=f;}
    });
    if(found){
      map.getView().fit(found.getGeometry().getExtent(), {maxZoom:19});
    }
  }
});

/* --- 5) Rotate notu --- */
// ğŸ”¹ Mobilde: iki parmak ile dÃ¶ndÃ¼rebilirsin
// ğŸ”¹ Desktop: ALT tuÅŸuna basÄ±lÄ± tutarak fare ile sÃ¼rÃ¼kle
</script>
</body>
</html>
