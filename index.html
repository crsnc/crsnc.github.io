<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>OpenLayers â€“ Indoor & Outdoor</title>

<!-- OpenLayers CSS & JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v9.2.4/ol.css">
<script src="https://cdn.jsdelivr.net/npm/ol@v9.2.4/dist/ol.js"></script>

<style>
  html, body {margin:0; padding:0; height:100%;}
  #map {width:100%; height:100%;}
  .toolbar {
    position:absolute; top:10px; left:10px; z-index:1000;
    background:#fff; padding:6px; border-radius:6px;
    box-shadow:0 2px 6px rgba(0,0,0,.2); display:flex; gap:6px;
  }
  .toolbar input {padding:6px; width:220px;}
</style>
</head>
<body>
<div id="map"></div>

<div class="toolbar">
  <input id="searchInput" type="text" placeholder="Ara: disco, havuz, restoran, spaâ€¦" />
</div>

<script>
/* ------------------ 1) Otel Polygonu ------------------ */
const hotelGeoJSON = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "geometry":{
        "type":"Polygon",
        "coordinates":[[ 
          [31.80488563536983,36.60144809135009],
          [31.80141125277774,36.599560719072684],
          [31.806994242514662,36.59688713533359],
          [31.80828178115803,36.59899633325935],
          [31.80488563536983,36.60144809135009]
        ]]
      }
    }
  ]
};

/* ------------------ 2) Indoor & Outdoor DEMO ------------------ */
const demoIndoor = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "properties":{"name":"Lobi","category":"lobby"},
      "geometry":{
        "type":"Polygon",
        "coordinates":[[
          [31.8050,36.6005],[31.8052,36.6005],[31.8052,36.6007],[31.8050,36.6007],[31.8050,36.6005]
        ]]
      }
    }
  ]
};
const demoOutdoor = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "properties":{"name":"Disco","category":"disco"},
      "geometry":{"type":"Point","coordinates":[31.8053,36.6002]}
    }
  ]
};

/* ------------------ 3) Katmanlar ------------------ */
const hotelLayer = new ol.layer.Vector({
  source: new ol.source.Vector({
    features: new ol.format.GeoJSON().readFeatures(hotelGeoJSON,{
      featureProjection:"EPSG:3857"
    })
  }),
  style: new ol.style.Style({
    stroke: new ol.style.Stroke({color:"blue",width:2}),
    fill: new ol.style.Fill({color:"rgba(0,0,255,0.05)"})
  })
});

const indoorLayer = new ol.layer.Vector({
  source: new ol.source.Vector({
    features: new ol.format.GeoJSON().readFeatures(demoIndoor,{
      featureProjection:"EPSG:3857"
    })
  }),
  style: new ol.style.Style({
    stroke: new ol.style.Stroke({color:"green",width:2}),
    fill: new ol.style.Fill({color:"rgba(0,255,0,0.3)"})
  })
});

const outdoorLayer = new ol.layer.Vector({
  source: new ol.source.Vector({
    features: new ol.format.GeoJSON().readFeatures(demoOutdoor,{
      featureProjection:"EPSG:3857"
    })
  }),
  style: new ol.style.Style({
    image: new ol.style.Circle({
      radius:6,
      fill: new ol.style.Fill({color:"red"}),
      stroke: new ol.style.Stroke({color:"#fff",width:2})
    })
  })
});

/* ------------------ 4) Map ve View ------------------ */
const map = new ol.Map({
  target: "map",
  layers: [
    new ol.layer.Tile({source: new ol.source.OSM()}),
    hotelLayer, indoorLayer, outdoorLayer
  ],
  view: new ol.View({
    center: ol.proj.fromLonLat([31.805,36.600]),
    zoom: 17,
    rotation: 0 // buradan rotate baÅŸlatÄ±lÄ±r
  })
});

/* ------------------ 5) Search ------------------ */
document.getElementById("searchInput").addEventListener("keydown", e=>{
  if(e.key==="Enter"){
    const val = e.target.value.toLowerCase();
    let found=null;
    outdoorLayer.getSource().forEachFeature(f=>{
      if(f.get("name") && f.get("name").toLowerCase().includes(val)){found=f;}
    });
    if(found){
      map.getView().fit(found.getGeometry().getExtent(), {maxZoom:19});
    }
  }
});

/* ------------------ 6) Rotate Notu ------------------ */
// ðŸ”¹ Mobilde: Ä°ki parmak ile dÃ¶ndÃ¼r
// ðŸ”¹ MasaÃ¼stÃ¼: ALT + Sol Fare tuÅŸu ile dÃ¶ndÃ¼r
</script>
</body>
</html>
